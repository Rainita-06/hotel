<!-- Add this button somewhere in your dashboard to allow users to enable notifications -->
<!-- You can add this to the navbar or settings page -->

<button 
  id="enable-notifications-btn"
  onclick="enablePushNotifications()"
  class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2"
>
  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
  </svg>
  <span>Enable Notifications</span>
</button>

<script>
async function enablePushNotifications() {
  const btn = document.getElementById('enable-notifications-btn');
  
  try {
    btn.disabled = true;
    btn.innerHTML = '<span>Requesting permission...</span>';
    
    // Request permission and get token
    const token = await window.enableNotifications();
    
    if (token) {
      btn.innerHTML = `
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span>Notifications Enabled!</span>
      `;
      btn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
      btn.classList.add('bg-green-600', 'cursor-default');
      
      // Show success message
      alert('Push notifications enabled successfully!');
    } else {
      throw new Error('Failed to get FCM token');
    }
  } catch (error) {
    console.error('Error enabling notifications:', error);
    btn.disabled = false;
    btn.innerHTML = `
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
      </svg>
      <span>Enable Notifications</span>
    `;
    alert('Failed to enable notifications. Please check permissions.');
  }
}

// Auto-check if notifications are already enabled
document.addEventListener('DOMContentLoaded', () => {
  if (Notification.permission === 'granted') {
    const btn = document.getElementById('enable-notifications-btn');
    if (btn) {
      btn.innerHTML = `
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span>Notifications Enabled</span>
      `;
      btn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
      btn.classList.add('bg-green-600', 'cursor-default');
      btn.disabled = true;
    }
  }
});
</script>
