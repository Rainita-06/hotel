<div class="w-full h-96 bg-white rounded-xl shadow-md border border-gray-200 p-5">
    <div class="text-gray-900 text-lg font-semibold mb-4 font-['Inter']">Feedback Sentiment (Last 7 Days)</div>
    <canvas id="feedback-chart" class="w-full h-72"></canvas>
</div>

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    let parsed;
    try {
        parsed = JSON.parse('{{ feedback_data|escapejs }}');
    } catch (e) {
        parsed = null;
    }

    const labels = parsed && parsed.labels ? parsed.labels : ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    const positive = parsed && parsed.positive ? parsed.positive : [70, 80, 75, 90, 85, 95, 100];
    const neutral = parsed && parsed.neutral ? parsed.neutral : [20, 25, 30, 25, 35, 30, 25];
    const negative = parsed && parsed.negative ? parsed.negative : [15, 10, 20, 15, 12, 10, 8];

    const ctx = document.getElementById('feedback-chart').getContext('2d');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                { label: 'Positive', data: positive, borderColor: '#10B981', backgroundColor: '#10B98133', tension: 0.3, fill: true },
                { label: 'Neutral', data: neutral, borderColor: '#FBBF24', backgroundColor: '#FBBF2433', tension: 0.3, fill: true },
                { label: 'Negative', data: negative, borderColor: '#EF4444', backgroundColor: '#EF444433', tension: 0.3, fill: true }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            layout: { padding: { bottom: 20 } },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { color: '#4B5563', stepSize: 5 }
                },
                x: {
                    ticks: {
                        color: '#4B5563',
                        maxRotation: 0,
                        minRotation: 0
                    }
                }
            },
            plugins: { legend: { position: 'bottom' } }
        }
    });
});
</script>
{% endblock %}
