{% extends "dashboard/base_dashboard.html" %}
{% block title %}Breakfast Voucher{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 flex justify-center items-center py-8">
  <div class="w-[1184px]">
    <!-- Header -->
    <div class="h-20 px-6 py-4 bg-white border-b border-gray-200 inline-flex justify-center items-center">
      <div class="flex-1 h-12 flex justify-between items-center">
        <div class="flex justify-start items-center gap-4">
          <div class="inline-flex flex-col justify-center items-start">
            <div class="inline-flex justify-start items-center">
              <h1 class="w-[1100px] text-gray-900 text-2xl font-bold font-['Inter']">Guest Check-In & Breakfast Voucher</h1>
            </div>
            <div class="inline-flex justify-center items-center">
              <p class="w-[1100px] text-gray-600 text-sm font-normal font-['Inter']">Register guests and generate breakfast voucher with QR code</p>
            </div>
          </div>
        </div>
      </div>
    </div>
{% include 'partials/breakfast_tab.html' %}
    {% if voucher %}
    <!-- Voucher Card -->
    <div class="w-[1107px] h-[497px] bg-white rounded-xl shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] border-gray-200 overflow-hidden mt-6">
      <!-- Voucher Header -->
      <div class="w-full h-14 px-8 bg-sky-600 border-gray-200 inline-flex justify-between items-center">
        <div class="flex justify-start items-center gap-3">
          <div class="w-4 h-7">
            <div class="w-4 h-4 inline-flex justify-center items-center mt-1">
              <div class="w-4 h-4 bg-white rounded"></div>
            </div>
          </div>
          <div class="text-white text-lg font-bold font-['Inter']">Breakfast Voucher Generated</div>
        </div>
        <div class="opacity-90">
          <div class="text-white text-sm font-normal font-['Inter']">Voucher Code: {{ voucher.voucher_code }}</div>
        </div>
      </div>

      <!-- Voucher Body -->
      <div class="w-full h-96">
        <div class="flex justify-start items-start gap-8 p-8">
          <!-- Guest Details -->
          <div class="flex-1">
            <div class="w-[496px]">
              <!-- Guest Name -->
              <div class="h-12 py-3 border-b border-gray-200 inline-flex justify-start items-start">
                <div class="w-60">
                  <div class="text-gray-900 text-base font-semibold font-['Inter']">Guest Name</div>
                </div>
                <div class="w-60">
                  <div class="text-gray-900 text-base font-normal font-['Inter']">{{ voucher.guest_name }}</div>
                </div>
              </div>

              <!-- Room Number -->
              <div class="h-12 py-3 border-b border-gray-200 inline-flex justify-start items-start">
                <div class="w-60">
                  <div class="text-gray-900 text-base font-semibold font-['Inter']">Room Number</div>
                </div>
                <div class="w-60">
                  <div class="text-gray-900 text-base font-normal font-['Inter']">{{ voucher.room_no }}</div>
                </div>
              </div>

              <!-- Adults -->
              <div class="h-12 py-3 border-b border-gray-200 inline-flex justify-start items-start">
                <div class="w-60">
                  <div class="text-gray-900 text-base font-semibold font-['Inter']">Adults</div>
                </div>
                <div class="w-60">
                  <div class="text-gray-900 text-base font-normal font-['Inter']">{{ voucher.adults }}</div>
                </div>
              </div>

              <!-- Kids -->
              <div class="h-12 py-3 border-b border-gray-200 inline-flex justify-start items-start">
                <div class="w-60">
                  <div class="text-gray-900 text-base font-semibold font-['Inter']">Kids</div>
                </div>
                <div class="w-60">
                  <div class="text-gray-900 text-base font-normal font-['Inter']">{{ voucher.kids }}</div>
                </div>
              </div>

              <!-- Check-in Date -->
              <div class="h-12 py-3 border-b border-gray-200 inline-flex justify-start items-start">
                <div class="w-60">
                  <div class="text-gray-900 text-base font-semibold font-['Inter']">Check-in Date</div>
                </div>
                <div class="w-60">
                  <div class="text-gray-900 text-base font-normal font-['Inter']">{{ voucher.check_in_date|date:"M. d, Y" }}</div>
                </div>
              </div>

              <!-- Check-out Date -->
              <div class="h-12 py-3 inline-flex justify-start items-start">
                <div class="w-60">
                  <div class="text-gray-900 text-base font-semibold font-['Inter']">Check-out Date</div>
                </div>
                <div class="w-60">
                  <div class="text-gray-900 text-base font-normal font-['Inter']">
                    {% if voucher.check_out_date %}{{ voucher.check_out_date|date:"M. d, Y" }}{% else %}N/A{% endif %}
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- QR Code Section -->
          {% if qr_absolute_url %}
          <div class="w-64">
            <div class="w-64 h-56 bg-gray-100 rounded-lg outline outline-1 outline-offset-[-1px] outline-gray-200 p-4">
              <img src="{{ qr_absolute_url }}" alt="Voucher QR Code" class="w-32 h-32 mx-auto mb-2">
              <div class="text-center">
                <div class="text-gray-500 text-sm font-medium font-['Inter']">Scan to Redeem Breakfast</div>
                <div class="text-gray-500 text-sm font-medium font-['Inter']">Voucher</div>
              </div>
            </div>
          </div>
          {% endif %}
        </div>

        <!-- Action Buttons -->
        <div class="w-full h-12 px-8 inline-flex justify-center items-start gap-4">
          <!-- WhatsApp Share -->
          <a href="https://wa.me/{{ voucher.country_code}}{{ voucher.phone_number }}?text=View%20your%20voucher%20here:%20{{ landing_url|urlencode }}" 
             target="_blank"
             class="w-56 h-12 px-6 py-3 bg-green-500 rounded-xl border-gray-200 flex justify-start items-center gap-2 hover:bg-green-600 transition-colors">
            <div class="w-4 h-7">
              <div class="w-4 h-4 inline-flex justify-center items-center mt-1">
                <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.149-.67.149-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414-.074-.123-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                </svg>
              </div>
            </div>
            <div class="text-white text-base font-medium font-['Inter']">Share on WhatsApp</div>
          </a>

          <!-- View Voucher Page -->
          <a href="{{ landing_url }}" target="_blank"
             class="w-48 h-12 bg-blue-600 rounded-xl border-gray-200 flex justify-center items-center hover:bg-blue-700 transition-colors">
            <div class="text-white text-base font-medium font-['Inter']">View Voucher Page</div>
          </a>

          <!-- Download QR Code -->
          <a href="{{ qr_absolute_url }}"
             download="Room{{voucher.room_no}}_{{voucher.guest_name}}_Adults{{voucher.adults}}_Kids{{voucher.kids}}.png"
             class="w-48 h-12 rounded-xl outline outline-1 outline-offset-[-1px] outline-gray-500 flex justify-center items-center hover:bg-gray-50 transition-colors">
            <div class="text-gray-500 text-base font-medium font-['Inter']">Download QR Code</div>
          </a>
        </div>
      </div>

      <!-- Check-out Section -->
      <div class="text-center p-4">
        {% if not voucher.check_out_date %}
          <a href="{% url 'checkout' voucher.id %}" class="px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors inline-block">
            Mark Check-Out
          </a>
        {% else %}
          <p class="text-green-600 font-bold text-lg">Checked out on: {{ voucher.check_out_date}}</p>
        {% endif %}
      </div>
    </div>
    {% else %}
    <!-- No Voucher Message -->
    <div class="w-[1107px] bg-yellow-50 border border-yellow-200 rounded-lg p-6 mt-6">
      <div class="text-center">
        <svg class="w-12 h-12 text-yellow-500 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
        </svg>
        <p class="text-yellow-800 text-lg font-medium">No voucher created (Breakfast not included).</p>
      </div>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}